:root{
  --bg:#0b0f16;
  --bg-elev:#0f1520;
  --card:#121a27;
  --text:#e6edf3;
  --muted:#9fb0c1;
  --accent:#6dc5ff;
  --accent-2:#7af3c5;
  --border:rgba(255,255,255,0.08);
  --shadow:0 10px 30px rgba(0,0,0,0.35);
  --mouse-x:0.5;
  --mouse-y:0.5;
  --neon-blue:#0077b6;
  --neon-blue-2:#0099cc;
  --sidebar-width:280px;
  --bg-tint: rgba(109,197,255,0.10);
  --scan-tint: rgba(109,197,255,0.05);
}
/* Theme: Red Neon (overrides key color variables) */
.theme-red{
  --accent:#ff6b6b;
  --accent-2:#ffb199;
  --neon-blue:#ff3b5c;
  --neon-blue-2:#ff7a7a;
  --bg-tint: rgba(255,59,92,0.12);
  --scan-tint: rgba(255,59,92,0.06);
}
/* Additional themes */
.theme-green{
  --accent:#65d18f;
  --accent-2:#a5f5cf;
  --neon-blue:#11d67a;
  --neon-blue-2:#65ffbf;
  --bg-tint: rgba(17,214,122,0.12);
  --scan-tint: rgba(17,214,122,0.06);
}
.theme-yellow{
  --accent:#e0c15a;
  --accent-2:#ffe48b;
  --neon-blue:#ffcc33;
  --neon-blue-2:#ffe066;
  --bg-tint: rgba(255,204,51,0.12);
  --scan-tint: rgba(255,204,51,0.06);
}
.theme-purple{
  --accent:#a95bff;
  --accent-2:#d0a6ff;
  --neon-blue:#a95bff;
  --neon-blue-2:#d0a6ff;
  --bg-tint: rgba(169,91,255,0.12);
  --scan-tint: rgba(169,91,255,0.06);
}
.theme-cyan{
  --accent:#44b3ff;
  --accent-2:#7ad0ff;
  --neon-blue:#00d4ff;
  --neon-blue-2:#6ee6ff;
  --bg-tint: rgba(0,212,255,0.12);
  --scan-tint: rgba(0,212,255,0.06);
}
.theme-pink{
  --accent:#ff66c4;
  --accent-2:#ff9ae0;
  --neon-blue:#ff3bf1;
  --neon-blue-2:#ff85f1;
  --bg-tint: rgba(255,59,241,0.12);
  --scan-tint: rgba(255,59,241,0.06);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--text);
  background:radial-gradient(1200px 800px at 10% -20%, var(--bg-tint), transparent 60%),
             var(--bg);
}

.layout{display:grid; grid-template-columns:280px 1fr; height:100%}
.sidebar{
  border-right:1px solid var(--border);
  background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%), var(--bg-elev);
  padding:24px 16px;
  display:flex; flex-direction:column; gap:16px;
  position:relative;
  /* ensure neon line sits on top of header bar */
  border-right-color:transparent;
  z-index:3;
}
.sidebar::after{
  content:""; position:absolute; top:0; right:-1px; width:3px; height:100%; pointer-events:none; z-index:1;
  background:linear-gradient(180deg, transparent 0%, var(--neon-blue) 15%, var(--neon-blue-2) 50%, var(--neon-blue) 85%, transparent 100%);
  box-shadow:0 0 14px var(--neon-blue), 0 0 28px rgba(7, 79, 233, 0.55), inset 0 0 1px rgba(255,255,255,0.2);
  opacity:.95; animation:neonPulse 3.2s ease-in-out infinite;
}
.brand{display:flex; align-items:center; gap:12px; padding:4px 8px}
.logo{
  width:36px; height:36px; display:grid; place-items:center;
  border-radius:10px; background:linear-gradient(135deg, rgba(109,197,255,0.25), rgba(122,243,197,0.18));
  color:#08121a; box-shadow:var(--shadow); border:1px solid var(--border);
  position:relative;
}
.logo-svg{width:28px; height:28px; display:block}
.logo-svg .neon{stroke:url(#logo-grad); filter:url(#logo-glow)}
.logo-svg .ring{fill:none; stroke-width:2; stroke-linecap:round; stroke-dasharray:4 6; animation:dash 8s linear infinite}
.logo-svg .s-stroke{fill:none; stroke-width:2; stroke-linecap:round}
.logo-svg .d-stroke{fill:none; stroke-width:2; stroke-linecap:round}
@keyframes dash{to{stroke-dashoffset:-80}}

/* Logo text overlays */
.logo-letters{
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center; gap:1px; pointer-events:none; transform:scale(0.95);
}
.logo-letters > span{
  font-weight:800; font-size:10px; line-height:1; letter-spacing:0.1px;
  background:linear-gradient(135deg, var(--accent), var(--accent-2));
  -webkit-background-clip:text; background-clip:text; color:transparent;
  text-shadow:0 0 4px rgba(109,197,255,0.35), 0 0 8px rgba(122,243,197,0.18);
}
.title{font-weight:700; letter-spacing:0.4px}
.nav{display:flex; flex-direction:column; gap:6px; margin-top:8px}
.nav-item{
  display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:10px; color:var(--muted);
  text-decoration:none; transition:all .16s ease; cursor:pointer; position:relative;
}
.nav-item:hover{background:rgba(255,255,255,0.04); color:var(--text)}
.nav-item.active{background:linear-gradient(180deg, rgba(109,197,255,0.15), rgba(122,243,197,0.12)); color:var(--text); border:1px solid var(--border)}
.nav-item.active::after{
  content:""; position:absolute; left:10px; right:10px; bottom:6px; height:2px; pointer-events:none; border-radius:2px;
  background:linear-gradient(90deg, var(--neon-blue), var(--neon-blue-2));
  box-shadow:0 0 8px color-mix(in oklab, var(--neon-blue) 60%, transparent);
}
.spacer{flex:1}
.status{display:flex; align-items:center; gap:8px; padding:10px 12px; border-top:1px solid var(--border); margin-top:8px}
.dot{width:10px; height:10px; border-radius:50%; background:#888; box-shadow:0 0 10px rgba(0,0,0,0.4)}
.status-text{font-size:12px; color:var(--muted)}

/* Noir animated background */
.noir-background{position:fixed; inset:0; z-index:-1; overflow:hidden; pointer-events:none; background:var(--bg)}
.noir-background .gradient-layer{position:absolute; inset:0; background:linear-gradient(45deg, var(--bg) 0%, var(--bg-elev) 25%, #121723 50%, var(--bg-elev) 75%, var(--bg) 100%); background-size:400% 400%; animation:nb-gradient 16s ease-in-out infinite}
@keyframes nb-gradient{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
.noir-background .film-grain{position:absolute; inset:0; opacity:0.12; background-image:radial-gradient(circle at 20% 80%, transparent 50%, rgba(255,255,255,0.10) 50.1%), radial-gradient(circle at 80% 20%, transparent 50%, rgba(255,255,255,0.08) 50.1%), radial-gradient(circle at 40% 40%, transparent 50%, rgba(255,255,255,0.05) 50.1%); background-size:3px 3px,4px 4px,2px 2px; animation:nb-grain .55s steps(10) infinite}
@keyframes nb-grain{0%{transform:translate(0,0)}20%{transform:translate(1px,-1px)}40%{transform:translate(-1px,1px)}60%{transform:translate(0,1px)}80%{transform:translate(-1px,0)}100%{transform:translate(0,0)}}
.noir-background .vignette{position:absolute; inset:0; background:radial-gradient(ellipse at center, transparent 30%, rgba(0,0,0,0.35) 70%, rgba(0,0,0,0.7) 100%)}
.noir-background .parallax-layer{position:absolute; inset:0}
.noir-background .grid-layer{position:absolute; inset:0; opacity:0.14; background-image: linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px); background-size: 24px 24px, 24px 24px; transform: translateX(calc((var(--mouse-x) - 0.5)*8px)) translateY(calc((var(--mouse-y) - 0.5)*8px)); transition: transform .4s ease-out}
.noir-background .grid-layer::after{content:""; position:absolute; inset:0; background-image: linear-gradient(rgba(109,197,255,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(122,243,197,0.04) 1px, transparent 1px); background-size: 96px 96px, 96px 96px; mix-blend-mode:screen; opacity:0.25}
.noir-background .scan-sweep{position:absolute; inset:-20% 0 auto 0; height:40%; background:linear-gradient(180deg, transparent, var(--scan-tint), transparent); transform: translateY(calc((var(--mouse-y) - 0.5)*-20px)); animation:nb-scan 14s linear infinite; opacity:.35}
@keyframes nb-scan{0%{top:-40%}100%{top:140%}}
.noir-background .glow-orb-1,.noir-background .glow-orb-2{position:absolute; border-radius:50%; will-change:transform; transition:transform .6s ease-out}
.noir-background .glow-orb-1{width:280px; height:280px; top:12%; right:20%; background:radial-gradient(circle, color-mix(in oklab, var(--accent) 12%, transparent) 0%, transparent 70%); transform:translateX(calc(var(--mouse-x)*-60px + 30px)) translateY(calc(var(--mouse-y)*-40px + 20px)); animation:nb-float 16s ease-in-out infinite}
.noir-background .glow-orb-2{width:200px; height:200px; bottom:22%; left:25%; background:radial-gradient(circle, color-mix(in oklab, var(--accent-2) 10%, transparent) 0%, transparent 70%); transform:translateX(calc(var(--mouse-x)*50px - 25px)) translateY(calc(var(--mouse-y)*35px - 18px)); animation:nb-float 18s ease-in-out infinite reverse}
@keyframes nb-float{0%,100%{transform:translateX(0) translateY(0)}33%{transform:translateX(6px) translateY(-4px)}66%{transform:translateX(-4px) translateY(6px)}}

.content{position:relative}
.topbar{display:flex; align-items:center; justify-content:space-between; padding:20px 28px; border-bottom:1px solid var(--border); -webkit-backdrop-filter:saturate(120%) blur(8px); backdrop-filter:saturate(120%) blur(8px); position:relative; border-bottom-color:transparent; z-index:1}
.topbar::after{
  content:""; position:absolute; left:calc(-1 * var(--sidebar-width)); right:0; bottom:-1px; height:3px; pointer-events:none; z-index:0;
  background:linear-gradient(90deg, transparent 0%, var(--neon-blue) 12%, var(--neon-blue-2) 50%, var(--neon-blue) 88%, transparent 100%);
  box-shadow:0 0 12px var(--neon-blue), 0 0 24px rgba(7, 79, 233, 0.55);
  opacity:.95; animation:neonPulse 3s ease-in-out infinite;
}

@keyframes neonPulse{0%,100%{opacity:.75}50%{opacity:1}}

@media (prefers-reduced-motion: reduce){
  .sidebar::after, .topbar::after{animation:none}
}
.topbar h1{margin:0; font-size:18px}
.btn{
  background:linear-gradient(135deg, rgba(109,197,255,0.2), rgba(122,243,197,0.18));
  color:var(--text); border:1px solid var(--border); padding:10px 14px; border-radius:10px; cursor:pointer;
}
.btn:hover{filter:brightness(1.1)}

/* Settings theme radio spacing */
.theme-options label{margin-right:14px}

.view{display:none; padding:24px 28px}
.view.active{display:block}
.cards{display:grid; grid-template-columns:repeat(auto-fill, minmax(280px,1fr)); gap:16px}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%), var(--card);
  border:1px solid var(--border); border-radius:14px; padding:18px; box-shadow:var(--shadow)
}
.card-title{font-weight:600; margin-bottom:8px}
.metric{display:flex; align-items:baseline; gap:8px; margin:10px 0 6px}
.metric-value{font-size:26px; font-weight:700}
.metric-label{font-size:12px; color:var(--muted)}
.kv{display:grid; gap:6px}
.kv .k{color:var(--muted); min-width:60px} 
.kv .v{font-variant-numeric:tabular-nums}
.status-online{color:#11d67a; font-weight:500}
.status-offline{color:#e05555; font-weight:500}
.links{list-style:none; padding:0; margin:8px 0 0}
.links li{margin:6px 0}
.links a{color:var(--accent); text-decoration:none}
.links a:hover{text-decoration:underline}

.section-header{display:flex; align-items:center; justify-content:space-between; margin-bottom:16px}
.placeholder{color:var(--muted); border:1px dashed var(--border); padding:16px; border-radius:12px; background:rgba(255,255,255,0.02)}

/* Toolbar & inputs */
.toolbar{display:flex; gap:10px; align-items:center; margin:8px 0 16px}
.input{flex:1; background:rgba(255,255,255,0.06); border:1px solid var(--border); color:var(--text); padding:10px 12px; border-radius:10px; outline:none}
.input:focus{border-color:rgba(109,197,255,0.5)}
/* Ensure dark styling applies to selects as well */
select.input{
  -webkit-appearance:none; appearance:none;
  background-color:rgba(255,255,255,0.06);
  color:var(--text);
  border:1px solid var(--border);
  padding-right:28px; /* room for arrow */
}
select.input:focus{border-color:rgba(109,197,255,0.5)}
select.input option{background:var(--bg-elev); color:var(--text)}

/* NPC list */
.npc-layout{display:grid; grid-template-columns:1fr 320px; gap:16px}
.npc-list{display:grid; grid-template-columns:repeat(auto-fill, minmax(220px, 1fr)); gap:12px}
.npc-card{display:flex; gap:12px; align-items:center; padding:12px; border:1px solid var(--border); border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%), var(--card); box-shadow:var(--shadow);
  transition: transform .16s ease, box-shadow .2s ease, border-color .2s ease; will-change: transform; position:relative}
.npc-card:hover{transform:translateY(-2px) scale(1.02); 
  border-color: var(--neon-blue);
  box-shadow:0 14px 32px rgba(0,0,0,0.45), 0 0 16px rgba(0,153,204,0.35), inset 0 0 6px rgba(0,153,204,0.18)}
.npc-card::before{
  content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none; padding:1px;
  background:linear-gradient(90deg, var(--neon-blue), var(--neon-blue-2));
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; /* Chrome/Safari */
  mask-composite: exclude;      /* Firefox */
  opacity:0; transition:opacity .16s ease, filter .16s ease;
}
.npc-card:hover::before{opacity:.7; filter:drop-shadow(0 0 10px var(--neon-blue));}
.npc-card:active{transform:scale(0.98)}
.npc-card.clicked{animation:card-press .18s ease}
@keyframes card-press{0%{transform:scale(1)}50%{transform:scale(0.97)}100%{transform:scale(1)}}
.npc-card.clickable{cursor:pointer}
.npc-card.selected{outline:2px solid var(--accent)}
.npc-photo{width:56px; height:56px; border-radius:10px; overflow:hidden; background:rgba(30,30,40,0.8); display:grid; place-items:center; border:1px solid var(--border)}
.npc-photo img{width:100%; height:100%; object-fit:contain; display:block}
.npc-meta{display:flex; flex-direction:column; min-width:0}
.npc-name{font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
.npc-surname{display:none}
.npc-hptext{font-size:12px; margin-top:4px}
.hp-high{color:#65d18f}
.hp-med{color:#e0c15a}
.hp-low{color:#e05555}
.npc-hp{position:relative; margin-top:6px; width:140px; height:8px; border-radius:6px; background:rgba(255,255,255,0.08); border:1px solid var(--border); overflow:hidden}
.npc-hp-fill{height:100%; background:linear-gradient(90deg, #65d18f, #44b3ff); box-shadow:0 0 8px rgba(68,179,255,0.4) inset}
.npc-hp-label{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; color:#e05555; letter-spacing:0.5px; text-shadow:0 1px 2px rgba(0,0,0,0.6); pointer-events:none}
.hp-dead{color:#e05555}

/* KO bar (details page) */
.npc-ko{position:relative; margin-top:8px; width:240px; height:8px; border-radius:6px; background:rgba(255,255,255,0.08); border:1px solid var(--border); overflow:hidden}
.npc-ko-fill{height:100%; background:linear-gradient(90deg, #ffb347, #ffcc33); box-shadow:0 0 8px rgba(255,180,70,0.35) inset}
.npc-ko-label{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; color:#ffb347; letter-spacing:0.4px; text-shadow:0 1px 2px rgba(0,0,0,0.5); pointer-events:none}

/* KO bar (list mini) */
.npc-ko-mini{position:relative; margin-top:6px; width:140px; height:6px; border-radius:6px; background:rgba(255,255,255,0.08); border:1px solid var(--border); overflow:hidden}
.npc-ko-fill-mini{height:100%; background:linear-gradient(90deg, #ffb347, #ffcc33)}
.npc-ko-label-mini{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:700; color:#ffb347; letter-spacing:0.3px; text-shadow:0 1px 1px rgba(0,0,0,0.5); pointer-events:none}

/* Details panel */
.npc-details{position:sticky; top:20px; align-self:start; border:1px solid var(--border); border-radius:12px; padding:14px; background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%), var(--card); box-shadow:var(--shadow)}
.npc-details.hidden{display:none}
.npc-details-header{display:flex; gap:12px; align-items:center; margin-bottom:12px}
.npc-details-photo{width:72px; height:72px; border-radius:12px; overflow:hidden; border:1px solid var(--border); background:rgba(30,30,40,0.8); display:grid; place-items:center}
.npc-details-photo img{width:100%; height:100%; object-fit:contain}
.npc-det-name{font-weight:700}
.npc-det-hptext{font-size:14px; margin:4px 0}
.npc-det-hp{width:180px}
.hidden{display:none}

/* NPC full page */
.npc-page{display:grid; grid-template-columns:120px 1fr; gap:16px}
.npc-page .npc-details-photo{width:120px; height:120px}
.npc-page .npc-det-hp{width:240px}
.npc-page .npc-details-body{grid-column:1 / -1; margin-top:16px}

/* NPC detail sections */
.detail-section{margin:16px 0; padding:16px; border:1px solid var(--border); border-radius:12px; background:rgba(255,255,255,0.02)}
.detail-section h3{margin:0 0 12px; font-size:16px; color:var(--accent)}
.detail-row{display:flex; margin:8px 0}
.detail-label{width:100px; color:var(--muted); font-size:14px}
.detail-value{flex:1; font-size:14px}
.dev-actions{display:flex; flex-wrap:wrap; gap:8px}
.dev-actions .btn{flex:0 0 auto}
.dev-status{margin-top:10px; font-size:13px; color:var(--muted)}
.dev-status-info{color:var(--muted)}
.dev-status-ok{color:#11d67a}
.dev-status-error{color:#e05555}

/* Utilities */
.form-row{display:flex; align-items:center; gap:8px}
.form-row.is-zero{display:none}
.row-actions{margin-top:8px; display:flex; gap:8px}
.mt-10{margin-top:10px}
.mt-20{margin-top:20px}

/* Bars */
.bar{position:relative; width:240px; height:8px; border-radius:6px; background:rgba(255,255,255,0.08); border:1px solid var(--border); overflow:hidden}
.bar-fill{height:100%; width:0%; transition:width .2s ease}
.bar-health .bar-fill{background:linear-gradient(90deg, #65d18f, #44b3ff)}
.bar-need .bar-fill{background:linear-gradient(90deg, #ffb347, #ffcc33)}
.bar-status .bar-fill{background:linear-gradient(90deg, #e05555, #ff8a80)}

@media (max-width: 900px){
  .layout{grid-template-columns:1fr}
  .sidebar{position:sticky; top:0; z-index:10; border-right:none; border-bottom:1px solid var(--border); flex-direction:row; align-items:center}
  .nav{flex-direction:row; overflow:auto}
  .status{border-top:none}
  .npc-layout{grid-template-columns:1fr}
  .npc-details{position:relative; top:auto}
  .npc-page{grid-template-columns:1fr}
}
